(this["webpackJsonpreact-app"]=this["webpackJsonpreact-app"]||[]).push([[0],{108:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),l=t(26),o=t.n(l),c=(t(81),t(63)),i=t(64),m=t(75),u=t(74),s=t(117),d=t(118),E=t(20),p=t(6),f=t(30),h=t(8),g=t(36),v=t.n(g),y="http://localhost:3000/api",b=function(){var e={};return localStorage.getItem("token")&&(e.Authorization="Bearer "+localStorage.getItem("token")),e},C={get:function(e,a,t){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(t||(t={params:{},headers:{}}),t.baseURL=y,a)for(var r in t.params={},a)void 0!==a[r]&&(t.params[r]=a[r]);return n&&(t.headers.Authorization=b().Authorization),v.a.get(e,t)},post:function(e,a,t){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return t||(t={headers:{}}),t.baseURL=y,n&&(t.headers.Authorization=b().Authorization),v.a.post(e,a,t)},put:function(e,a,t){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return t||(t={headers:{}}),t.baseURL=y,n&&(t.headers.Authorization=b().Authorization),v.a.put(e,a,t)},delete:function(e,a){var t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return a||(a={headers:{}}),a.baseURL=y,t&&(a.headers.Authorization=b().Authorization),v.a.delete(e,a)},patch:function(e,a,t){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return t||(t={headers:{}}),t.baseURL=y,n&&(t.headers.Authorization=b().Authorization),v.a.patch(e,a,t)}},k={search:function(e,a,t,n,r){return C.get("restaurants",{name:e,day:a,time:t,page:n,limit:r},void 0,!1)}},w={register:function(e){return C.post("/users",e,void 0,!1)},collections:function(){return C.get("/users/collections")},login:function(e){return C.post("users/login",e,void 0,!1).then((function(a){var t=a&&a.data||{},n=t.id,r=t.token;return localStorage.setItem("id",n),localStorage.setItem("token",r),localStorage.setItem("email",e.email),a.data}))},logout:function(){localStorage.removeItem("id"),localStorage.removeItem("token"),localStorage.removeItem("email")}},S={create:function(e){return C.post("/collections",{name:e})},add:function(e,a){return C.put("/collections/".concat(e,"/add"),{restaurantId:a})},remove:function(e,a){return C.delete("/collections/".concat(e,"/remove/").concat(a))},update:function(e,a){return C.put("/collections/".concat(e),{name:a})},delete:function(e){return C.delete("/collections/".concat(e))}},O=t(16),L=t(119),j=t(110),N=t(116),T=t(120),I=t(111),A=t(67),z=t(66),q=t(112),D=t(113),P=t(115);var F=function(){for(var e=Object(f.a)({defaultValues:{name:void 0,date:O().format("YYYY-MM-DD"),time:O().format("HH:mm")}}),a=e.register,t=e.handleSubmit,l=e.watch,o=e.setValue,c=Object(h.k)(),i=Object(n.useState)(void 0),m=Object(p.a)(i,2),u=m[0],s=m[1],d=Object(n.useState)([]),E=Object(p.a)(d,2),g=E[0],v=E[1],y=Object(n.useState)(void 0),b=Object(p.a)(y,2),C=b[0],F=b[1],U=function(e,a,t,n){u||(s(!0),k.search(e,a,t,n||R.page,R.limit).then((function(e){s(!1);var a=e&&e.data||{},t=a.data,n=a.limit,r=a.page,l=a.total,o=a.totalPages;v(t),B({limit:n,page:r,total:l,totalPages:o})})))},H=Object(n.useState)({page:1,limit:5,total:0,totalPages:0}),_=Object(p.a)(H,2),R=_[0],B=_[1],Y=[],x=function(e){Y.push(r.a.createElement(L.a.Item,{key:e,active:R.page===e,onClick:function(){var a;a=e,U(l("name"),l("date")?O.utc(l("date")).toDate().getDay():void 0,l("time")?ue(se(l("time"))):void 0,a)}},e))},M=1;M<=R.totalPages;M++)x(M);var V=Object(n.useState)([]),J=Object(p.a)(V,2),W=J[0],$=J[1],G=Object(n.useState)(!1),K=Object(p.a)(G,2),Q=K[0],X=K[1],Z=function(){return X(!0)},ee=function(){X(!1)},ae=Object(n.useState)(!1),te=Object(p.a)(ae,2),ne=te[0],re=te[1],le=function(){re(!1)},oe=Object(f.a)({}),ce=oe.register,ie=oe.handleSubmit,me=oe.errors,ue=function(e){var a=new Date(0);return a.setUTCHours(e?e.getHours():0),a.setUTCMinutes(e?e.getMinutes():0),a.getTime()},se=function(e){return e?O(e,"HH:mm").toDate():void 0},de=function(e,a){var t=se(l("time"));if(!t)return!1;var n=ue(t);return e<a?n>=e&&n<=a:n>=e||n<=a},Ee=function(e){var a=l("date");return!!a&&e===O(a,"YYYY-MM-DD").toDate().getDay()};return Object(n.useEffect)((function(){U(void 0,(new Date).getDay(),ue(new Date))}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,null,r.a.createElement(N.a,{noValidate:!0,autoComplete:"off",onSubmit:t((function(e){var a=e.date,t=e.time,n=e.name;U(n,a?O.utc(a).toDate().getDay():void 0,t?ue(se(t)):void 0,1)}))},r.a.createElement(T.a,{className:"mt-2"},r.a.createElement(T.a.Body,null,r.a.createElement(T.a.Title,null," ",r.a.createElement("h5",null," Search for restaurant ")),r.a.createElement(I.a,null,r.a.createElement(A.a,{md:"4"},r.a.createElement(z.a,null,r.a.createElement(N.a.Label,null," Name "),r.a.createElement(N.a.Control,{name:"name",type:"text",id:"name",placeholder:"Type name here",ref:a()}))),r.a.createElement(A.a,{md:"4"},r.a.createElement(z.a,null,r.a.createElement(N.a.Label,null," Date "),r.a.createElement(N.a.Control,{name:"date",type:"date",id:"date",ref:a()}))),r.a.createElement(A.a,{md:"4"},r.a.createElement(z.a,null,r.a.createElement(N.a.Label,null," Time "),r.a.createElement(N.a.Control,{name:"time",type:"time",id:"time",ref:a()}))))),r.a.createElement(T.a.Footer,null,r.a.createElement(I.a,null,r.a.createElement(A.a,{md:{span:4,offset:4}},r.a.createElement(q.a,{className:"form-control",type:"submit",variant:"primary"}," Apply Search ")),r.a.createElement(A.a,{md:"4"},r.a.createElement(q.a,{className:"form-control",type:"button",variant:"secondary",onClick:function(){o("name",void 0),o("date",void 0),o("time",void 0)}}," Clear Search "))))))),r.a.createElement(j.a,null,g&&g.length?r.a.createElement("div",null,r.a.createElement("h3",null," Result: ",R.total," "),g.map((function(e){return r.a.createElement(T.a,{className:"mb-3",key:e._id},r.a.createElement(T.a.Header,null,e.name,r.a.createElement(q.a,{className:"float-right",type:"button",size:"sm",variant:"primary",onClick:function(){return a=e._id,void(localStorage.getItem("id")?(F(a),w.collections().then((function(e){$(e&&e.data&&e.data.data||[]),Z()}))):c.push("/login"));var a}}," Add to collection ")),r.a.createElement(T.a.Body,null,(a=e.schedule,a.reduce((function(e,a){var t=a.day,n=a.startTime,r=a.endTime,l=a._id,o=e.filter((function(e){return e.startTime===n&&e.endTime===r}))[0];return o?o.days.push(t):e.push({_id:l,startTime:n,endTime:r,days:[t]}),e}),[])).map((function(e){return r.a.createElement(D.a,{pill:!0,variant:l("time")&&de(e.startTime,e.endTime)?"warning":"light",key:e._id},e.days.map((function(e){return r.a.createElement(D.a,{pill:!0,className:"mr-2",variant:l("date")&&Ee(e)?"warning":"light",key:e}," ",function(e){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e]}(e)," ")})),r.a.createElement("span",null,O.utc(e.startTime).format("hh:mm:ss a")," - ",O.utc(e.endTime).format("hh:mm:ss a")," "))}))));var a})),r.a.createElement(L.a,null,Y)):r.a.createElement("div",null,r.a.createElement("h3",null,"No Result Found"))),r.a.createElement(P.a,{show:Q,onHide:ee},r.a.createElement(P.a.Header,null," Select Collection "),r.a.createElement(P.a.Body,{className:"text-center"},W.map((function(e){return r.a.createElement(q.a,{block:!0,variant:"secondary",onClick:function(){return a=e._id,void S.add(a,C).then((function(){ee()})).catch((function(){ee()}));var a},key:e._id}," ",e.name," (",e.restaurants.length,") ")}))),r.a.createElement(P.a.Footer,null,r.a.createElement(q.a,{className:"form-control",variant:"primary",onClick:function(){return re(!0)}}," New Collection "),r.a.createElement(q.a,{className:"form-control",variant:"secondary",onClick:ee}," Cancel "))),r.a.createElement(P.a,{show:ne,onHide:le},r.a.createElement(N.a,{noValidate:!0,autoComplete:"off",onSubmit:ie((function(e){S.create(e.name).then((function(e){le(),w.collections().then((function(e){$(e&&e.data&&e.data.data||[]),Z()}))}))}))},r.a.createElement(P.a.Header,null," Create New Collection "),r.a.createElement(P.a.Body,{className:"text-center"},r.a.createElement(z.a,null,r.a.createElement(N.a.Label,null," Collection Name "),r.a.createElement(N.a.Control,{name:"name",type:"text",id:"name",placeholder:"Enter collection name",ref:ce({required:!0}),isInvalid:me.name}),me.name&&r.a.createElement(N.a.Control.Feedback,{type:"invalid"},"required"===me.name.type&&r.a.createElement("p",null,"Name is required")))),r.a.createElement(P.a.Footer,null,r.a.createElement(q.a,{className:"form-control",type:"submit",variant:"primary"}," Submit "),r.a.createElement(q.a,{className:"form-control",variant:"secondary",onClick:le}," Cancel ")))))},U=t(114);var H=function(){var e=Object(f.a)(),a=e.register,t=e.handleSubmit,l=e.errors,o=e.watch,c=Object(h.k)(),i=Object(n.useState)(void 0),m=Object(p.a)(i,2),u=m[0],s=m[1],d=Object(n.useState)(!1),g=Object(p.a)(d,2),v=g[0],y=g[1],b=function(){y(!1),c.push("/login")};return r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,null,r.a.createElement(I.a,{className:"mt-5"},r.a.createElement(A.a,{md:{span:8,offset:2}},r.a.createElement(N.a,{noValidate:!0,autoComplete:"off",onSubmit:t((function(e){return w.register(e).then((function(e){s(void 0),y(!0)})).catch((function(e){s(e&&e.response&&e.response.data&&e.response.data.toLowerCase().indexOf("duplicate")>=0?"Email already registered":"Internal Server Error")}))}))},r.a.createElement(T.a,null,r.a.createElement(T.a.Body,null,r.a.createElement(T.a.Title,null," ",r.a.createElement("h5",null," Registration ")),u&&r.a.createElement(U.a,{variant:"danger"}," ",u," "),r.a.createElement(I.a,null,r.a.createElement(A.a,null,r.a.createElement(z.a,null,r.a.createElement(N.a.Label,null," Email "),r.a.createElement(N.a.Control,{name:"email",type:"email",id:"email",placeholder:"Enter email",ref:a({required:!0,pattern:/[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$/}),isInvalid:l.email}),l.email&&r.a.createElement(N.a.Control.Feedback,{type:"invalid"},"required"===l.email.type&&r.a.createElement("p",null,"Email is required"),"pattern"===l.email.type&&r.a.createElement("p",null,"Email is invalid!"))),r.a.createElement(z.a,null,r.a.createElement(N.a.Label,null," Password "),r.a.createElement(N.a.Control,{name:"password",type:"password",id:"password",placeholder:"Enter password",ref:a({required:!0}),isInvalid:l.password}),l.password&&r.a.createElement(N.a.Control.Feedback,{type:"invalid"},"required"===l.password.type&&r.a.createElement("p",null,"Password is required"))),r.a.createElement(z.a,null,r.a.createElement(N.a.Label,null," Retype Password "),r.a.createElement(N.a.Control,{name:"retypePassword",type:"password",id:"retypePassword",placeholder:"Retype password",ref:a({required:!0,validate:function(e){return e===o("password")}}),isInvalid:l.retypePassword}),l.retypePassword&&r.a.createElement(N.a.Control.Feedback,{type:"invalid"},"required"===l.retypePassword.type&&r.a.createElement("p",null,"Please retype password"),"validate"===l.retypePassword.type&&r.a.createElement("p",null,"Passwords did not match")))))),r.a.createElement(T.a.Footer,null,r.a.createElement(I.a,null,r.a.createElement(A.a,{md:"6",lg:"4"},r.a.createElement(q.a,{className:"form-control",type:"submit",variant:"primary"}," Submit ")),r.a.createElement(A.a,{md:"6",lg:"4"},r.a.createElement(E.LinkContainer,{to:"/"},r.a.createElement(q.a,{className:"form-control",type:"button",variant:"secondary"}," Cancel ")))))))))),r.a.createElement(P.a,{show:v,onHide:b},r.a.createElement(P.a.Body,{className:"text-center"},r.a.createElement("p",null," Successfully Registered! "),r.a.createElement(q.a,{variant:"primary",onClick:b}," Ok "))))};var _=function(e){var a=Object(f.a)(),t=a.register,l=a.handleSubmit,o=a.errors,c=Object(h.k)(),i=Object(n.useState)(void 0),m=Object(p.a)(i,2),u=m[0],s=m[1];return r.a.createElement(j.a,null,r.a.createElement(I.a,{className:"mt-5"},r.a.createElement(A.a,{md:{span:8,offset:2}},r.a.createElement(N.a,{noValidate:!0,autoComplete:"off",onSubmit:l((function(a){return w.login(a).then((function(a){s(void 0),e.onAuthUpdate(),c.push("/")})).catch((function(e){s(e&&e.response&&e.response.data&&e.response.data.message||"Unable to login. Check credentials")}))}))},r.a.createElement(T.a,null,r.a.createElement(T.a.Body,null,r.a.createElement(T.a.Title,null," ",r.a.createElement("h5",null," Login ")),u&&r.a.createElement(U.a,{variant:"danger"}," ",u," "),r.a.createElement(I.a,null,r.a.createElement(A.a,null,r.a.createElement(z.a,null,r.a.createElement(N.a.Label,null," Email "),r.a.createElement(N.a.Control,{name:"email",type:"email",id:"email",placeholder:"Enter email",ref:t({required:!0,pattern:/[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$/}),isInvalid:o.email}),o.email&&r.a.createElement(N.a.Control.Feedback,{type:"invalid"},"required"===o.email.type&&r.a.createElement("p",null,"Email is required"),"pattern"===o.email.type&&r.a.createElement("p",null,"Email is invalid!"))),r.a.createElement(z.a,null,r.a.createElement(N.a.Label,null," Password "),r.a.createElement(N.a.Control,{name:"password",type:"password",id:"password",placeholder:"Enter password",ref:t({required:!0}),isInvalid:o.password}),o.password&&r.a.createElement(N.a.Control.Feedback,{type:"invalid"},"required"===o.password.type&&r.a.createElement("p",null,"Password is required")))))),r.a.createElement(T.a.Footer,null,r.a.createElement(I.a,null,r.a.createElement(A.a,{md:"4"},r.a.createElement(q.a,{className:"form-control",type:"submit",variant:"primary"}," Login ")),r.a.createElement(A.a,{md:"4"},r.a.createElement(E.LinkContainer,{to:"/register"},r.a.createElement(q.a,{className:"form-control",type:"button",variant:"success"}," Register "))),r.a.createElement(A.a,{md:"4"},r.a.createElement(E.LinkContainer,{to:"/"},r.a.createElement(q.a,{className:"form-control",type:"button",variant:"secondary"}," Cancel "))))))))))};var R=function(){var e=Object(n.useState)([]),a=Object(p.a)(e,2),t=a[0],l=a[1];return Object(n.useEffect)((function(){w.collections().then((function(e){l(e&&e.data?e.data.data:[])}))}),[]),r.a.createElement(j.a,null,r.a.createElement("h3",null," Your Collections: "),t.map((function(e){return r.a.createElement(T.a,{key:e._id},r.a.createElement(T.a.Header,null,e.name," Collection",e.owners.map((function(e){return r.a.createElement(D.a,{key:e._id,variant:"warning",pill:!0,className:"mr-2"}," ",e.email," ")}))),r.a.createElement(T.a.Body,null,e.restaurants.map((function(e){return r.a.createElement(T.a,{className:"mb-3",key:e._id},r.a.createElement(T.a.Header,null," ",e.name," "),r.a.createElement(T.a.Body,null,(a=e.schedule,a.reduce((function(e,a){var t=a.day,n=a.startTime,r=a.endTime,l=a._id,o=e.filter((function(e){return e.startTime===n&&e.endTime===r}))[0];return o?o.days.push(t):e.push({_id:l,startTime:n,endTime:r,days:[t]}),e}),[])).map((function(e){return r.a.createElement(D.a,{pill:!0,variant:"light",key:e._id},e.days.map((function(e){return r.a.createElement(D.a,{pill:!0,className:"mr-2",variant:"light",key:e}," ",function(e){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e]}(e)," ")})),r.a.createElement("span",null,O.utc(e.startTime).format("hh:mm:ss a")," - ",O.utc(e.endTime).format("hh:mm:ss a")," "))}))));var a}))))})))},B=t(28),Y=function(e){Object(m.a)(t,e);var a=Object(u.a)(t);function t(){var e;return Object(c.a)(this,t),(e=a.call(this)).state={isLoggedIn:!1,user:void 0},e.isLoggedIn=function(){return!!localStorage.getItem("email")},e.getUser=function(){return localStorage.getItem("email")},e.logout=function(){w.logout(),e.onAuthUpdate()},e.onAuthUpdate=function(){e.setState({isLoggedIn:e.isLoggedIn(),user:e.getUser()})},e.state={isLoggedIn:e.isLoggedIn(),user:e.getUser()},e}return Object(i.a)(t,[{key:"render",value:function(){var e=this.state.isLoggedIn?r.a.createElement("span",{className:"float-right"},"Hi ",this.state.user,"!"):"",a=r.a.createElement(s.a,{className:"mr-auto"},r.a.createElement(E.LinkContainer,{to:"/login"},r.a.createElement(s.a.Link,null," Login "))),t=r.a.createElement(s.a,{className:"mr-auto"},r.a.createElement(E.LinkContainer,{to:"/collections"},r.a.createElement(s.a.Link,null,"Collections")),r.a.createElement(s.a.Link,{onClick:this.logout},"Logout")),n=this.state.isLoggedIn?t:a;return r.a.createElement(B.BrowserRouter,null,r.a.createElement("div",null,r.a.createElement(d.a,{bg:"light",expand:"lg"},r.a.createElement(E.LinkContainer,{to:"/"},r.a.createElement(d.a.Brand,null,"Demo Restaurants App")),e,r.a.createElement(d.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(d.a.Collapse,{id:"basic-navbar-nav"},n)),r.a.createElement(h.g,null,r.a.createElement(h.d,{path:"/login"},r.a.createElement(_,{onAuthUpdate:this.onAuthUpdate})),r.a.createElement(h.d,{path:"/register"},r.a.createElement(H,null)),r.a.createElement(h.d,{path:"/collections"},r.a.createElement(R,null)),r.a.createElement(h.d,{path:"/"},r.a.createElement(F,null)))))}}]),t}(n.Component);o.a.render(r.a.createElement(Y,null),document.getElementById("root"))},76:function(e,a,t){e.exports=t(108)}},[[76,1,2]]]);
//# sourceMappingURL=main.0990ce2f.chunk.js.map